<!DOCTYPE html>
<html class="fancyScroll">
<head>
  <meta charset="utf-8">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  
  <link href="../../../css/vuetify.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

  <title>PyNode&#43; Air Quality Examples </title>
  <meta name="description" content="">

  <script src="../../../js/smooth-scroll.js"></script>
  <link href="../../../css/doc-theme.css%3F.css" rel="stylesheet">
  <link rel="icon" href="../../../favicon.ico">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
</head>
<body>
</script>
<v-app id="app" class=""  v-cloak style="background-color: white;">
   <v-navigation-drawer
  v-model="drawer"
  fixed
  app
  class="lighten-4 pt-0"
  style="overflow-y: hidden; overflow-x: hidden;margin-top:68px;"
>

  <div class="fancyScroll pa-0 ma-0" style="overflow-y: scroll; overflow-x: hidden;
      max-height: 100%;" >

    <v-divider class="mr-2 ml-1 mb-4" style="border: 0"></v-divider>

      <ul class="lefttree">
        <li class="lefttree">
            <a href="../../../index.html" class="beba" style="color: #1E1E3C; text-decoration: none;" >
              <v-icon style="color: #1E1E3C;">home</v-icon> Introduction</a>
        </li>
      </ul>

    


<ul class="lefttree ">

  
  
  
  
  


    <li class="lefttree ">
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../gettingstarted/registration/lora/helium_hotspot_registration/index.html" class="">Pycom Helium Miner</a>
    </li>

  

  
  
  
  
  


    <li class="lefttree ">
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../products/index.html" class="">Pycom Products</a>
    </li>

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../gettingstarted/index.html" class="">  Getting Started</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree padleft hot" >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../index.html" class="hot">  Tutorials &amp; Examples</a>
      
      
        


<ul class="lefttree ">

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../basic/index.html" class="">  Basic</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../hardware/index.html" class="">  Hardware</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../networks/index.html" class="">  Networks</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../networkprotocols/index.html" class="">  Network Protocols</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../expansionboards/index.html" class="">  Shields</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree padleft hot" >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../index.html" class="hot">  PyNode&#43;</a>
      
      
        


<ul class="lefttree ">

  
  
  
  
  


    <li class="lefttree ">
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../pynodeair/index.html" class="">PyNode&#43; Air</a>
    </li>

  

  
  
  
  
  


    <li class="lefttree hot">
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="index.html" class="hot">PyNode&#43; AirQ</a>
    </li>

  

</ul>

      

      
    </li>
      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../advanced/index.html" class="">  Advanced</a>
      
      

      

  

</ul>

      

      
    </li>
      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../firmwareapi/index.html" class="">  Firmware &amp; API Reference</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../datasheets/index.html" class="">  Product Info, Datasheets</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../updatefirmware/index.html" class="">  Update Firmware</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../pybytes/index.html" class="">  Pybytes</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../cellularservices/index.html" class="">  Cellular Services</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../pylife/index.html" class="">  Pylife</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../pymesh.html" class="">  Pymesh</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../docnotes/index.html" class="">  Micropython Support</a>
      
      

      

  

  
  
  
  
  

  
    <li class="lefttree " >
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../advance/downgrade.html" class="">  Advanced topics</a>
      
      

      

  

  
  
  
  
  


    <li class="lefttree ">
      <v-icon style="color: transparent; display: hidden;" >done</v-icon>
      <a href="../../../license/index.html" class="">License</a>
    </li>

  

</ul>


    <v-divider class="grey lighten-1 ma-2 mt-4 mb-4"></v-divider>

    <ul class="lefttree" >Have a question ?
      <li class="lefttree">  <a href="https://forum.pycom.io">Ask on the forum</a>
    </ul>
    <p>&nbsp;</p>
      <p>&nbsp;</p>
  </div>
</v-navigation-drawer>
<v-toolbar
  app
  fixed
  height=68
  class="pr-3 pl-2 navbar"
  dark
  style="background-color: #171730;"
  flat
>
  <v-toolbar-title style="width: 260px; " class="ml-4 pl-0  pt-2 text-xs-center hidden-sm-and-down">
    <v-img class="ml-4"  height=48 width=190  src="/logo.svg" class="">
  </v-toolbar-title>

    <v-btn icon @click.stop="drawer = !drawer" style="z-index: 1200;">
      <v-icon>toc</v-icon>
    </v-btn>
    <span class="beba" style="font-size: 1.6rem; opacity: 0.85;">
        PyNode&#43; Air Quality Examples
    </span>

  <v-text-field
    style="max-width: 650px"
    class="ml-3 algolia-search-field"
    light
    hide-details
    label="Search the docs..."
    solo
    append-icon="search"
  ></v-text-field>

  <v-spacer></v-spacer>
  <v-btn icon ref="tocBtn" @click.stop="drawer2 = !drawer2" >
    <v-icon style="color: rgb(23, 255, 189);">more_vert</v-icon>
  </v-btn>
  
</v-toolbar>
<v-content >
      <v-container class="fluid pa-4" style="padding-top: 0 !important;">
          <v-container class="ma-1 pa-1"><v-slide-y-transition>
    <v-card class="menu-contextual" v-if="drawer2" @click.stop="drawer2 = !drawer2">
      <v-card-title class="beba" style="height: 68px; background-color: #1E1E3C; color: #17FFBD">
        What's in this document
        <v-btn icon @click.stop="drawer2 = !drawer2" style="color: #17FFBD; position: absolute; right: 0; top: 4px;;">
          <v-icon>more_vert</v-icon>
        </v-btn>


      </v-card-title>
      <v-card-text class="fancyScroll righttree">
    <nav id="TableOfContents"></nav>
      </v-card-text>
    </v-card>
</v-slide-y-transition>





<v-card flat class="DocSearch-content">
  <v-card-text>
    
    








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  


</ul>

    

  


</ul>

    

  






  
  

  

  
      

      <a href="../../index.html" class="bread hot">  Tutorials &amp; Examples</a>
        >
      
        








  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      

      <a href="../index.html" class="bread hot">  PyNode&#43;</a>
        >
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      <a href="index.html" class="bread">PyNode&#43; AirQ </a>

      

      
      

        

  
  


</ul>

    


    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  


</ul>

    

  


</ul>

    


    

  






  
  

  

  
      
        








  
  

  

  
      
        








  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
      
        








  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  


</ul>

    

  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
      
        








  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
      
        








  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  






  
  

  

  
    

      

  
  


</ul>

    

  






  
  

  

  
    

      

  
  


</ul>

    
    <h1 class="mt-0 pt-0">PyNode&#43; Air Quality Examples</h1><p>You can use the following code to query the PyNode+ Air Quality sensor from MicroPython</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">network</span> <span style="color:#007020;font-weight:bold">import</span> Bluetooth
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">time</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">ubinascii</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">struct</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">math</span>

bt <span style="color:#666">=</span> Bluetooth()
bt<span style="color:#666">.</span>start_scan(<span style="color:#666">-</span><span style="color:#40a070">1</span>)

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">twoscmp</span>(value):
    <span style="color:#007020;font-weight:bold">if</span> value <span style="color:#666">&gt;</span> <span style="color:#40a070">128</span>:
        value <span style="color:#666">=</span> value <span style="color:#666">-</span> <span style="color:#40a070">256</span>
    <span style="color:#007020;font-weight:bold">return</span> value

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">byte_to_info</span>(uuid):
    gas_res_d <span style="color:#666">=</span> <span style="color:#40a070">0</span>
    name <span style="color:#666">=</span> uuid[<span style="color:#40a070">0</span>:<span style="color:#40a070">3</span>]
    name_text <span style="color:#666">=</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">&#39;</span><span style="color:#666">.</span>join(<span style="color:#007020">chr</span>(t) <span style="color:#007020;font-weight:bold">for</span> t <span style="color:#007020;font-weight:bold">in</span> name)
    <span style="color:#007020;font-weight:bold">if</span> name_text <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">PyN</span><span style="color:#4070a0">&#34;</span>:
        sensor_id <span style="color:#666">=</span> uuid[<span style="color:#40a070">7</span>]
        mac <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(uuid[<span style="color:#40a070">10</span>:<span style="color:#40a070">16</span>])
        press <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(uuid[<span style="color:#40a070">8</span>:<span style="color:#40a070">10</span>])
        press_d <span style="color:#666">=</span> <span style="color:#007020">int</span>(press, <span style="color:#40a070">16</span>)
        gas_res <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(uuid[<span style="color:#40a070">3</span>:<span style="color:#40a070">7</span>])
        gas_res_d <span style="color:#666">=</span> <span style="color:#007020">int</span>(gas_res, <span style="color:#40a070">16</span>)
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">{} {} BLE_MAC: {}, Pressure: {} hPa, Gas resistance: {} ohm</span><span style="color:#4070a0">&#34;</span><span style="color:#666">.</span>format(name_text, sensor_id, mac, press_d, gas_res_d), end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">, </span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">return</span> (name_text,gas_res_d)

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">air_quality_score</span>(hum, gas_res):
    gas_reference <span style="color:#666">=</span> <span style="color:#40a070">250000</span>
    hum_reference <span style="color:#666">=</span> <span style="color:#40a070">40</span>
    gas_lower_limit <span style="color:#666">=</span> <span style="color:#40a070">5000</span>
    gas_upper_limit <span style="color:#666">=</span> <span style="color:#40a070">50000</span>
    <span style="color:#007020;font-weight:bold">if</span> (hum <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">38</span> <span style="color:#007020;font-weight:bold">and</span> hum <span style="color:#666">&lt;</span><span style="color:#666">=</span> <span style="color:#40a070">42</span>):
        hum_score <span style="color:#666">=</span> <span style="color:#40a070">0.25</span><span style="color:#666">*</span><span style="color:#40a070">100</span>
    <span style="color:#007020;font-weight:bold">else</span>:
        <span style="color:#007020;font-weight:bold">if</span> (hum <span style="color:#666">&lt;</span> <span style="color:#40a070">38</span>):
            hum_score <span style="color:#666">=</span> <span style="color:#40a070">0.25</span><span style="color:#666">/</span>hum_reference<span style="color:#666">*</span>hum<span style="color:#666">*</span><span style="color:#40a070">100</span>
        <span style="color:#007020;font-weight:bold">else</span>:
            hum_score <span style="color:#666">=</span> ((<span style="color:#666">-</span><span style="color:#40a070">0.25</span><span style="color:#666">/</span>(<span style="color:#40a070">100</span><span style="color:#666">-</span>hum_reference)<span style="color:#666">*</span>hum)<span style="color:#666">+</span><span style="color:#40a070">0.416666</span>)<span style="color:#666">*</span><span style="color:#40a070">100</span>
    <span style="color:#007020;font-weight:bold">if</span> (gas_reference <span style="color:#666">&gt;</span> gas_upper_limit):
        gas_reference <span style="color:#666">=</span> gas_upper_limit
    <span style="color:#007020;font-weight:bold">if</span> (gas_reference <span style="color:#666">&lt;</span> gas_lower_limit):
        gas_reference <span style="color:#666">=</span> gas_lower_limit
    gas_score <span style="color:#666">=</span> (<span style="color:#40a070">0.75</span><span style="color:#666">/</span>(gas_upper_limit<span style="color:#666">-</span>gas_lower_limit)<span style="color:#666">*</span>gas_reference <span style="color:#666">-</span>(gas_lower_limit<span style="color:#666">*</span>(<span style="color:#40a070">0.75</span><span style="color:#666">/</span>(gas_upper_limit<span style="color:#666">-</span>gas_lower_limit))))<span style="color:#666">*</span><span style="color:#40a070">100</span>
    air_quality_score <span style="color:#666">=</span> hum_score <span style="color:#666">+</span> gas_score

    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">IAQ score:</span><span style="color:#4070a0">&#34;</span>, air_quality_score)

    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Air quality is</span><span style="color:#4070a0">&#34;</span>, end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0"> </span><span style="color:#4070a0">&#34;</span>)
    air_quality_score <span style="color:#666">=</span> (<span style="color:#40a070">100</span><span style="color:#666">-</span>air_quality_score)<span style="color:#666">*</span><span style="color:#40a070">5</span>
    <span style="color:#007020;font-weight:bold">if</span> (air_quality_score <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">301</span>):
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Hazardous</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">elif</span> (air_quality_score <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">201</span> <span style="color:#007020;font-weight:bold">and</span> air_quality_score <span style="color:#666">&lt;</span><span style="color:#666">=</span> <span style="color:#40a070">300</span> ):
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Very Unhealthy</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">elif</span> (air_quality_score <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">176</span> <span style="color:#007020;font-weight:bold">and</span> air_quality_score <span style="color:#666">&lt;</span><span style="color:#666">=</span> <span style="color:#40a070">200</span> ):
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Unhealthy</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">elif</span> (air_quality_score <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">151</span> <span style="color:#007020;font-weight:bold">and</span> air_quality_score <span style="color:#666">&lt;</span><span style="color:#666">=</span> <span style="color:#40a070">175</span> ):
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Unhealthy for Sensitive Groups</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">elif</span> (air_quality_score <span style="color:#666">&gt;</span><span style="color:#666">=</span>  <span style="color:#40a070">51</span> <span style="color:#007020;font-weight:bold">and</span> air_quality_score <span style="color:#666">&lt;</span><span style="color:#666">=</span> <span style="color:#40a070">150</span> ):
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Moderate</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">elif</span> (air_quality_score <span style="color:#666">&gt;</span><span style="color:#666">=</span>  <span style="color:#40a070">00</span> <span style="color:#007020;font-weight:bold">and</span> air_quality_score <span style="color:#666">&lt;</span><span style="color:#666">=</span>  <span style="color:#40a070">50</span> ):
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Good</span><span style="color:#4070a0">&#34;</span>)

<span style="color:#007020;font-weight:bold">while</span> True:
    adv <span style="color:#666">=</span> bt<span style="color:#666">.</span>get_adv()
    <span style="color:#007020;font-weight:bold">if</span> adv: <span style="color:#60a0b0;font-style:italic"># and adv.rssi&gt;-80:# and ubinascii.hexlify(adv.mac)==b&#39;cd9e13c0f24a&#39;:</span>
        read_adv <span style="color:#666">=</span> bt<span style="color:#666">.</span>resolve_adv_data(adv<span style="color:#666">.</span>data, Bluetooth<span style="color:#666">.</span>ADV_MANUFACTURER_DATA)
        <span style="color:#007020;font-weight:bold">if</span> read_adv<span style="color:#666">==</span>None:
            <span style="color:#007020;font-weight:bold">pass</span>
        <span style="color:#007020;font-weight:bold">else</span>:
            manuf <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(read_adv)
            manuf_data <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(read_adv[<span style="color:#40a070">0</span>:<span style="color:#40a070">4</span>])
            <span style="color:#60a0b0;font-style:italic"># print(manuf_data)</span>
            <span style="color:#007020;font-weight:bold">if</span> (manuf_data <span style="color:#666">==</span> <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">4c000215</span><span style="color:#4070a0">&#39;</span>) :<span style="color:#60a0b0;font-style:italic">#or (manuf_data == b&#39;d2000215&#39;)):# company id=d2 is Dialog, b&#39;4c000215&#39; is Apple&#39;s id and it implies ibeacon</span>
                <span style="color:#60a0b0;font-style:italic"># print(&#34;mac:&#34;, ubinascii.hexlify(adv.mac))</span>
                uuid_raw <span style="color:#666">=</span> read_adv[<span style="color:#40a070">4</span>:<span style="color:#40a070">20</span>]
                uuid <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(uuid_raw)
                name, air<span style="color:#666">=</span>byte_to_info(uuid_raw)
                <span style="color:#007020;font-weight:bold">if</span> name <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">PyN</span><span style="color:#4070a0">&#34;</span>:
                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">rssi:</span><span style="color:#4070a0">&#34;</span>,adv<span style="color:#666">.</span>rssi)
                    major <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(read_adv[<span style="color:#40a070">20</span>:<span style="color:#40a070">22</span>])
                    minor <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(read_adv[<span style="color:#40a070">22</span>:<span style="color:#40a070">24</span>])
                    tx_power <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(read_adv[<span style="color:#40a070">24</span>:<span style="color:#40a070">25</span>])
                    tx_power_real <span style="color:#666">=</span> twoscmp(<span style="color:#007020">int</span>(tx_power, <span style="color:#40a070">16</span>))
                    major_int <span style="color:#666">=</span> <span style="color:#007020">int</span>(major, <span style="color:#40a070">16</span>)
                    major_f <span style="color:#666">=</span> major_int<span style="color:#666">/</span><span style="color:#40a070">100</span> <span style="color:#60a0b0;font-style:italic"># bme688</span>
                    minor_int <span style="color:#666">=</span> <span style="color:#007020">int</span>(minor,<span style="color:#40a070">16</span>)
                    minor_f <span style="color:#666">=</span> minor_int<span style="color:#666">/</span><span style="color:#40a070">100</span> <span style="color:#60a0b0;font-style:italic"># bme688, it is divided by 10 initially in the dialog&#39;s firmware.</span>
                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Temperature: {} C, Humidity: {} </span><span style="color:#70a0d0;font-style:italic">%r</span><span style="color:#4070a0">.H.</span><span style="color:#4070a0">&#34;</span><span style="color:#666">.</span>format(major_f, minor_f), time<span style="color:#666">.</span>time())
                    air_quality_score(minor_f, air)
                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">else</span>:
        time<span style="color:#666">.</span>sleep(<span style="color:#40a070">0.050</span>)
</code></pre></div><p>The below code can be used to modify the sleep duration.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">time</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">ubinascii</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">struct</span>

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">get_adv_int</span>(arg):
    time_msec <span style="color:#666">=</span> {
         <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">100ms</span><span style="color:#4070a0">&#39;</span>: <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\x01</span><span style="color:#4070a0">&#39;</span>, <span style="color:#60a0b0;font-style:italic"># 100ms</span>
         <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">200ms</span><span style="color:#4070a0">&#39;</span>: <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\x02</span><span style="color:#4070a0">&#39;</span>, <span style="color:#60a0b0;font-style:italic"># 200ms</span>
         <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">500ms</span><span style="color:#4070a0">&#39;</span>: <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\x05</span><span style="color:#4070a0">&#39;</span>, <span style="color:#60a0b0;font-style:italic"># 500ms</span>
        <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">1000ms</span><span style="color:#4070a0">&#39;</span>: <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\x10</span><span style="color:#4070a0">&#39;</span> <span style="color:#60a0b0;font-style:italic"># 1000ms</span>
    }
    <span style="color:#007020;font-weight:bold">return</span> time_msec<span style="color:#666">.</span>get(arg, <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0;font-weight:bold">\x00</span><span style="color:#4070a0">&#39;</span>) <span style="color:#60a0b0;font-style:italic"># default is 1000ms</span>

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">get_adv_dur</span>(time_value, scale):
    calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([<span style="color:#40a070">0</span>])
    <span style="color:#007020;font-weight:bold">if</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">ms</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">100</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">1000</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value<span style="color:#666">/</span><span style="color:#40a070">100</span>))])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">sec</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">1</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">10</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value) <span style="color:#666">|</span> <span style="color:#40a070">0x10</span>)])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">sec</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">10</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">60</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value<span style="color:#666">/</span><span style="color:#40a070">10</span>) <span style="color:#666">|</span> <span style="color:#40a070">0x20</span>)])
    <span style="color:#007020;font-weight:bold">return</span> calc_time

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">get_sleep_dur</span>(time_value, scale):
    calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([<span style="color:#40a070">0</span>])
    <span style="color:#007020;font-weight:bold">if</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">ms</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">100</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">1000</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value<span style="color:#666">/</span><span style="color:#40a070">100</span>))])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">sec</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">1</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">10</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value) <span style="color:#666">|</span> <span style="color:#40a070">0x10</span>)])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">sec</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">10</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">60</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value<span style="color:#666">/</span><span style="color:#40a070">10</span>) <span style="color:#666">|</span> <span style="color:#40a070">0x20</span>)])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">min</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">1</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">6</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value) <span style="color:#666">|</span> <span style="color:#40a070">0xA0</span>)])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">min</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">10</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">60</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(<span style="color:#007020">int</span>(time_value<span style="color:#666">/</span><span style="color:#40a070">10</span>) <span style="color:#666">|</span> <span style="color:#40a070">0xB0</span>)])
    <span style="color:#007020;font-weight:bold">elif</span> scale <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">hour</span><span style="color:#4070a0">&#39;</span>:
        <span style="color:#007020;font-weight:bold">if</span> time_value <span style="color:#666">&gt;</span><span style="color:#666">=</span> <span style="color:#40a070">1</span> <span style="color:#007020;font-weight:bold">and</span> time_value <span style="color:#666">&lt;</span> <span style="color:#40a070">12</span>:
            calc_time <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([(time_value <span style="color:#666">|</span> <span style="color:#40a070">0xC0</span>)])
    <span style="color:#007020;font-weight:bold">return</span> calc_time

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">measurement_count</span>(arg):
    count <span style="color:#666">=</span> <span style="color:#007020">bytes</span>([arg])
    <span style="color:#007020;font-weight:bold">return</span> count

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">twoscmp</span>(value):
    <span style="color:#007020;font-weight:bold">if</span> value <span style="color:#666">&gt;</span> <span style="color:#40a070">128</span>:
        value <span style="color:#666">=</span> value <span style="color:#666">-</span> <span style="color:#40a070">256</span>
    <span style="color:#007020;font-weight:bold">return</span> value

<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">change_adv</span>(adv_int, adv_dur, sleep_dur, meas_count):
    <span style="color:#007020;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">network</span> <span style="color:#007020;font-weight:bold">import</span> Bluetooth
    bt <span style="color:#666">=</span> Bluetooth()
    bt<span style="color:#666">.</span>start_scan(<span style="color:#666">-</span><span style="color:#40a070">1</span>)
    last_time <span style="color:#666">=</span> time<span style="color:#666">.</span>time()
    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">scanning |</span><span style="color:#4070a0">&#34;</span>, end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
    <span style="color:#007020;font-weight:bold">while</span> (time<span style="color:#666">.</span>time()<span style="color:#666">-</span>last_time)<span style="color:#666">&lt;</span><span style="color:#40a070">20</span>:
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0;font-weight:bold">\b</span><span style="color:#4070a0;font-weight:bold">\\</span><span style="color:#4070a0">&#34;</span>, end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
        time<span style="color:#666">.</span>sleep(<span style="color:#40a070">0.010</span>)
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0;font-weight:bold">\b</span><span style="color:#4070a0">-</span><span style="color:#4070a0">&#34;</span>, end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
        time<span style="color:#666">.</span>sleep(<span style="color:#40a070">0.010</span>)
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0;font-weight:bold">\b</span><span style="color:#4070a0">|</span><span style="color:#4070a0">&#34;</span>, end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
        time<span style="color:#666">.</span>sleep(<span style="color:#40a070">0.010</span>)
        <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0;font-weight:bold">\b</span><span style="color:#4070a0">/</span><span style="color:#4070a0">&#34;</span>, end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
        time<span style="color:#666">.</span>sleep(<span style="color:#40a070">0.010</span>)
        adv <span style="color:#666">=</span> bt<span style="color:#666">.</span>get_adv()
        <span style="color:#007020;font-weight:bold">if</span> adv <span style="color:#007020;font-weight:bold">and</span> bt<span style="color:#666">.</span>resolve_adv_data(adv<span style="color:#666">.</span>data, Bluetooth<span style="color:#666">.</span>ADV_NAME_CMPL) <span style="color:#666">==</span> <span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">PyNode+ Air Quality</span><span style="color:#4070a0">&#39;</span>:
            <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Found!</span><span style="color:#4070a0">&#34;</span>)
            <span style="color:#007020;font-weight:bold">try</span>:
                <span style="color:#007020;font-weight:bold">print</span>(adv<span style="color:#666">.</span>mac)
                conn <span style="color:#666">=</span> bt<span style="color:#666">.</span>connect(adv<span style="color:#666">.</span>mac)
                <span style="color:#007020;font-weight:bold">print</span>(adv<span style="color:#666">.</span>mac)
                services <span style="color:#666">=</span> conn<span style="color:#666">.</span>services()
                <span style="color:#007020;font-weight:bold">for</span> service <span style="color:#007020;font-weight:bold">in</span> services:
                    u <span style="color:#666">=</span> service<span style="color:#666">.</span>uuid()
                    time<span style="color:#666">.</span>sleep(<span style="color:#40a070">1</span>)
                    <span style="color:#007020;font-weight:bold">if</span> <span style="color:#007020">isinstance</span>(u, <span style="color:#007020">int</span>):
                        <span style="color:#007020;font-weight:bold">pass</span>
                    <span style="color:#007020;font-weight:bold">else</span>:
                        <span style="color:#007020;font-weight:bold">if</span> ubinascii<span style="color:#666">.</span>hexlify(u) <span style="color:#666">==</span> <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">595a08e4862a9e8fe911bc7c7c464218</span><span style="color:#4070a0">&#39;</span>:
                            chars <span style="color:#666">=</span> service<span style="color:#666">.</span>characteristics()
                            <span style="color:#007020;font-weight:bold">for</span> char <span style="color:#007020;font-weight:bold">in</span> chars:
                                c_uuid <span style="color:#666">=</span> char<span style="color:#666">.</span>uuid()
                                descriptor <span style="color:#666">=</span> char<span style="color:#666">.</span>read_descriptor(<span style="color:#40a070">0x2901</span>)
                                <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">&#34;</span>)
                                <span style="color:#007020;font-weight:bold">print</span>(descriptor<span style="color:#666">.</span>decode(<span style="color:#4070a0"></span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">utf-8</span><span style="color:#4070a0">&#39;</span>),end<span style="color:#666">=</span><span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0"> </span><span style="color:#4070a0">&#34;</span>)
                                c_hex <span style="color:#666">=</span> ubinascii<span style="color:#666">.</span>hexlify(c_uuid)
                                <span style="color:#007020;font-weight:bold">if</span> c_hex <span style="color:#666">==</span> <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">23ee8d0ce1f04a0cb325dc536a68862d</span><span style="color:#4070a0">&#39;</span>: <span style="color:#60a0b0;font-style:italic"># sleep duration</span>
                                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">is changed to:</span><span style="color:#4070a0">&#34;</span>, sleep_dur[<span style="color:#40a070">0</span>],sleep_dur[<span style="color:#40a070">1</span>])
                                    value <span style="color:#666">=</span> get_sleep_dur(sleep_dur[<span style="color:#40a070">0</span>], sleep_dur[<span style="color:#40a070">1</span>])
                                    char<span style="color:#666">.</span>write(value)
                                <span style="color:#007020;font-weight:bold">elif</span> c_hex <span style="color:#666">==</span> <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">25ee8d0ce1f04a0cb325dc536a68862d</span><span style="color:#4070a0">&#39;</span>: <span style="color:#60a0b0;font-style:italic"># advertising duration</span>
                                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">is changed to:</span><span style="color:#4070a0">&#34;</span>, adv_dur[<span style="color:#40a070">0</span>], adv_dur[<span style="color:#40a070">1</span>])
                                    value <span style="color:#666">=</span> get_adv_dur(adv_dur[<span style="color:#40a070">0</span>], adv_dur[<span style="color:#40a070">1</span>])
                                    char<span style="color:#666">.</span>write(value)
                                <span style="color:#007020;font-weight:bold">elif</span> c_hex <span style="color:#666">==</span> <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">22ee8d0ce1f04a0cb325dc536a68862d</span><span style="color:#4070a0">&#39;</span>: <span style="color:#60a0b0;font-style:italic"># advertising interval</span>
                                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">is changed to:</span><span style="color:#4070a0">&#34;</span>, adv_int)
                                    value <span style="color:#666">=</span> get_adv_int(adv_int)
                                    char<span style="color:#666">.</span>write(value)
                                <span style="color:#007020;font-weight:bold">elif</span> c_hex <span style="color:#666">==</span> <span style="color:#4070a0">b</span><span style="color:#4070a0">&#39;</span><span style="color:#4070a0">27ee8d0ce1f04a0cb325dc536a68862d</span><span style="color:#4070a0">&#39;</span>: <span style="color:#60a0b0;font-style:italic"># measurement count</span>
                                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">is changed to:</span><span style="color:#4070a0">&#34;</span>, (meas_count<span style="color:#666">*</span><span style="color:#40a070">5</span>))
                                    value <span style="color:#666">=</span> measurement_count(meas_count)
                                    char<span style="color:#666">.</span>write(value)
                                <span style="color:#007020;font-weight:bold">else</span>:
                                    <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0"> </span><span style="color:#4070a0">&#34;</span>)
                conn<span style="color:#666">.</span>disconnect()
                <span style="color:#007020;font-weight:bold">break</span>
            <span style="color:#007020;font-weight:bold">except</span> <span style="color:#007020">Exception</span> <span style="color:#007020;font-weight:bold">as</span> e:
                <span style="color:#007020;font-weight:bold">print</span>(e)
                <span style="color:#007020;font-weight:bold">if</span> conn:
                    conn<span style="color:#666">.</span>disconnect()
                bt<span style="color:#666">.</span>deinit()
                <span style="color:#007020;font-weight:bold">print</span>(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">Error while connecting or reading from the BLE device</span><span style="color:#4070a0">&#34;</span>)
                <span style="color:#007020;font-weight:bold">break</span>
        <span style="color:#007020;font-weight:bold">else</span>:
            time<span style="color:#666">.</span>sleep(<span style="color:#40a070">0.050</span>)

<span style="color:#60a0b0;font-style:italic"># try 5 secs sleep</span>
<span style="color:#60a0b0;font-style:italic"># change_adv(&#34;100ms&#34;,[1,&#34;sec&#34;],[1,&#34;min&#34;], 1)</span>


change_adv(<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">100ms</span><span style="color:#4070a0">&#34;</span>,[<span style="color:#40a070">200</span>,<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">ms</span><span style="color:#4070a0">&#34;</span>],[<span style="color:#40a070">100</span>,<span style="color:#4070a0"></span><span style="color:#4070a0">&#34;</span><span style="color:#4070a0">ms</span><span style="color:#4070a0">&#34;</span>], <span style="color:#40a070">255</span>) <span style="color:#60a0b0;font-style:italic"># 01, 02, 01, 255</span>
</code></pre></div></v-card-text>
</v-card>
    <p>&nbsp;</p>
    






  
  
    
  
  

  
  
    
  
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
    
    
  

  
  
    
  
  
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
        
        
        
          
        
        
        
      
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
      
      
        
      
      
        
        
        
          
        
        
        
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
        
        
        
      
      
    
    
    

      <v-layout class="full-width  prev-next pa-2 mt-4 mb-0" styleZZ="background-color: #7800FF;">
  <v-flex xs6 class="ppurple">
  
  <v-btn class="ml-4" href="/tutorials/pynode/pynodeair/">Previous</v-btn>
  
  </v-flex>
  <v-flex xs6 class="text-xs-right">
  <v-btn class="mr-4 pbgpurple white--text"  href="/tutorials/advanced/">Next</v-btn>
    </v-flex>
</v-layout>


    
    
      
    
    
      
      
      
        
      
      
      
    
    
  

  
  
    
  
  
    
    
    
      
    
    
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
          
          
          
            
          
          
          
          
            
          
          
          
          
            
          
          
          
          
            
          
          
          
          
            
          
          
          
          
            
          
          
          
          
            
          
          
        
        
        
          
        
        
        
          
          
          
            
          
          
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
      
      
      
        
      
      
        
        
        
          
        
        
        
      
      
      
      
        
      
      
        
        
        
          
        
        
        
        
        
          
        
        
        
      
      
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
  

  
  
    
  
  
    
    
    
      
    
    
      
      
      
        
      
      
      
      
      
        
      
      
      
    
    
    
    
      
    
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
  

  
  
    
  
  
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
    
    
      
    
    
    
  

  
  
    
  
  


    <v-spacer/>


          </v-container>
      </v-container>
    </v-content>
 </v-app>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vuetify/1.5.13/vuetify.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/1.5.1/vue-resource.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script>
    var development = false;
    var app = new Vue({
      el: '#app',
      data: {
        page: 1,
        pageCount: 0,
        error: null,
        results: null,
        drawer: true,
        drawer2: true,
        toc: 0,
        branches: [
        { value: 'https://docs.pycom.io', text: 'version stable'},
          { value: 'https://development.pycom.io', text: 'version development'},
          

        ],
        branch: ""
      },
      mounted: function () {
        
        this.branch= this.branches[0]
        for (b in this.branches) {
          if ( document.location.href.indexOf(this.branches[b].value) > -1) {
            this.branch= this.branches[b]
          }
        }
        
        
        if (this.$refs.tocBtn) {
          var elem = this.$refs.tocBtn.$el
          setTimeout(function () {
              elem.click();

          }, 3500);
        }
        var elem2 = document.getElementById("vuetify-theme-stylesheet");
        elem2.parentNode.removeChild(elem2);

      },
      watch: {
        
        branch: function (newb, old) {
          if (newb.value != this.branches[0].value) {
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
            window.location = newb + window.location.pathname;
          }
        },
      },
    });

    
    docsearch({
      apiKey: 'a99fde9999fbec81c1772eb9ffcca488',
      indexName: 'pycom',
      inputSelector: '.algolia-search-field input',
      debug: false 
    });
  </script>
<script type="text/javascript">
_atrk_opts = { atrk_acct:"WpWNq1SZw320l9", domain:"pycom.io",dynamic: true};
(function() { var as = document.createElement('script'); as.type = 'text/javascript'; as.async = true; as.src = "https://certify-js.alexametrics.com/atrk.js"; var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(as, s); })();
</script>
<noscript><img src="https://certify.alexametrics.com/atrk.gif?account=WpWNq1SZw320l9" style="display:none" height="1" width="1" alt="" /></noscript>


<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1216663,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-72107804-3', 'auto');
ga('send', 'pageview');
</script>
</body>
</html>
